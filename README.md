#Automated Home Application

##Description
[Live Demo](http://automated-home.herokuapp.com)  

The Automated Home App is a front end web application built with jQuery, JavaScript (ES6), and HTML5 Canvas elements. It provides a cheerful UI to control temperature, lighting, and curtain length in four different room. Initial settings are received via HTTP GET request when the document loads, with AJAX sending HTTP PATCH requests to update the server data every time a new adjustment is made. To check that these calls are being executed and updated successfully, `json-server` allows you to see the JSON data object stored at `(current_path)/rooms`.

A fun home visualizer animates the changes in realtime as controls are adjusted. See what happens when you change the temperature in the living room!   

##Running on local server
Install necessary node modules, including json-server, by running `npm-install`.

To get the mock server running, run `json-server db.json` in the command line or terminal. Once it's ready, you can connect via `localhost:3000`.

Note: `package.json` `scripts` and `main` keys are changed in the Heroku app to enable `json-server`.

##To update or extend application
The application takes advantage of JavaScript's modular ES6 "class" objects, and therefore can be modified both at the prototype and instance level with ease.

At the highest level, changes regarding the Canvas element, data and data handling functions are controlled by the ```main.js``` file. Once data is retrieved, a new `House` object is created with the `canvas`, `data`, and `updateDB()` functions passed in.

The `House` object iterates through the `rooms` array in the data and instantiates a new `Controls` object for each room in the house.

The `Controls` object stores the current and updated parameters for `light`, `temp`, and `curtain`, in addition to a variety of other variables. The `loadControls()` function uses jQuery to set up event handlers for elements on the DOM, instantiates the `Room` animation object that will be stored in `this.room`. The `patchServer()` function sets any updates as a JSON object to be passed back to the `updateDB()` function that was created at the `main.js` level. Updates to the database are only called if the jQuery slider is "changed" and has come to rest.

If no animation is desired, the `Room` objects and all associated functions can be deleted. The UI will still make `GET` and `PATCH` requests to the server and update accordingly. To enable the animation, `Room.start()` is called. Subsequently, any new client input will call `Room.update()` which will redraw the Canvas to simulate house changes. This feature is slightly more difficult to customize for different data sets, and is primarily for demo purposes.


##Structure of data
Data for client's house follows the schema below. If no animation is desired for the application, then the data can be slimmed down to 3-4 key-value pairs for each room. Each room object should also specify whether curtains are present, and sliders are displayed or hidden accordingly. Rooms are stored in an array and are iterated and instantiated at the `House` object level.
```
{rooms: [
  {
    "id": 1,
    "name": "living",
    "curtains": {
      "present": true,
      "col": "rgba(219,112,147, 0.7)",
      "x": 110,
      "y": 475,
      "w": 103,
      "max": 90
    },
    "dims": {
      "x": 85,
      "y": 435,
      "w": 378,
      "h": 300
    },
    "temp": 67,
    "light": 100,
    "curtain_height": 10
  }...
  ]}
  ```

##jQuery
The UI uses the jQuery UI Widget "Slider", modified by the Slim Slider css provided by AndreasStorm. Each Slider is tagged with an id that contains the name of the room, and therefore can be accessed from within a nested object with JavaScript string-interpolation. With more time, these sliders can be dynamically generated by jQuery to be customized for different houses.

Sample jQuery syntax for slider element:

  ```$( `#${name}-temp-slider` ).slider()
  ```

`Controls` function for grabbing values from the DOM and updating instance variables as well as the server:
    ```updateTemp(ui.value)
    ```

Just for fun, I added a jQuery fire texturizer created by Ramon Saquette to help visualize temperature changes in the living room. However, this texture required a slightly lower version of jQuery, which is why the included version is not the most recent.
```$('.fire').fire()
  $('.fire').fire('change',{maxPow:(this.temp-60)/5})
  draw()
  ```

##Technologies
- HTML5/Canvas
- Babel-ES5
- jQuery
- Mock API run on JSON-Server

##Styled Elements
- jQuery UI Widget Slider
- Slim Slider created by AndreasStorm
- JavaScript Fire Texture created by Ramon Saquete

##Tested Browsers
- Chrome
- Mozilla Firefox

##Future Improvements
- Dynamically generated controls / sliders based on rooms returned by the data, rather than hardcoded into the `index.html` file.
- Dynamically generated home visualizer for customization
- "Add Room" button
- Connect to an actual database. It actually would have been easier just to set up a MySQL or PostgreSQL rather than try to figure out how to get json-server working, but oh well. Trying new things!  
